#if 0
	shc Version 3.8.7, Generic Script Compiler
	Copyright (c) 1994-2009 Francisco Rosales <frosal@fi.upm.es>

	shc -v -r -T -f ./createDir.sh 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[1]))
	"\367\362\241\075\041\262\026\331\042\017\265"
#define      opts_z	1
#define      opts	((&data[11]))
	"\003"
#define      inlo_z	3
#define      inlo	((&data[12]))
	"\256\066\201"
#define      xecc_z	15
#define      xecc	((&data[18]))
	"\246\167\024\203\332\366\323\271\327\105\226\054\034\055\102\366"
	"\266\127\325"
#define      lsto_z	1
#define      lsto	((&data[34]))
	"\152"
#define      tst1_z	22
#define      tst1	((&data[40]))
	"\062\213\116\211\115\115\301\315\161\122\037\160\047\245\067\206"
	"\220\166\264\301\310\134\142\204\126\347\374\204\206\346"
#define      text_z	1504
#define      text	((&data[89]))
	"\271\315\130\246\001\374\330\071\311\120\337\100\145\264\204\223"
	"\016\011\203\264\074\017\003\305\213\172\227\123\376\307\337\321"
	"\111\204\341\367\120\125\247\135\153\164\110\246\270\037\273\163"
	"\273\303\252\257\364\263\203\374\224\335\012\053\324\355\242\326"
	"\276\114\176\315\007\035\110\243\242\101\332\312\340\172\215\366"
	"\240\354\223\055\020\156\050\077\273\162\375\073\050\110\344\313"
	"\110\354\146\302\070\077\146\012\261\265\365\203\121\363\352\065"
	"\244\224\150\065\243\374\045\165\047\104\305\316\175\053\147\261"
	"\374\325\104\147\336\307\132\302\114\317\035\261\336\340\260\102"
	"\176\152\233\216\370\057\052\237\227\211\301\270\043\336\216\122"
	"\262\037\213\026\306\004\062\134\247\340\057\321\271\044\255\270"
	"\220\322\114\247\127\336\115\107\253\145\232\121\362\361\163\070"
	"\350\030\031\277\162\117\355\257\163\154\217\057\377\250\105\127"
	"\101\234\010\065\162\271\062\207\032\363\063\037\315\345\326\240"
	"\022\122\307\305\004\224\167\207\110\157\316\062\366\010\371\350"
	"\305\234\255\322\204\234\215\001\332\274\306\054\074\103\366\253"
	"\220\276\362\164\350\134\240\034\320\114\116\035\231\255\017\233"
	"\357\351\002\211\226\112\371\135\217\345\200\333\154\021\117\247"
	"\265\220\142\057\226\206\237\310\366\051\234\260\007\326\334\337"
	"\027\111\227\152\077\013\252\005\126\367\254\027\002\066\322\024"
	"\210\126\334\177\246\305\376\326\213\131\150\376\025\130\336\252"
	"\034\073\040\377\327\126\134\256\256\156\354\000\163\255\374\211"
	"\312\204\043\011\162\256\361\210\243\377\332\367\003\102\044\374"
	"\201\256\343\227\152\140\067\355\257\163\131\200\014\237\241\171"
	"\002\045\133\226\103\224\067\042\272\226\061\050\127\053\226\343"
	"\226\333\166\161\014\251\203\153\250\027\045\124\045\174\377\001"
	"\112\203\022\310\164\113\352\127\107\117\213\153\356\017\360\231"
	"\353\271\323\230\217\054\175\017\345\304\123\220\276\357\247\057"
	"\236\071\014\202\276\301\064\221\364\232\132\176\127\317\144\174"
	"\247\205\245\277\253\272\314\257\351\277\313\125\220\114\257\026"
	"\137\362\350\252\322\300\006\075\034\024\064\252\175\320\276\001"
	"\155\324\001\275\236\133\261\216\337\315\015\276\344\042\275\210"
	"\063\036\207\007\170\254\106\325\221\105\247\272\142\312\014\200"
	"\377\175\261\246\262\301\052\067\204\006\316\034\203\173\352\373"
	"\172\057\074\057\244\247\360\315\225\241\001\224\264\336\106\346"
	"\160\134\273\367\346\044\021\032\333\313\120\312\123\262\366\332"
	"\261\176\371\326\357\275\044\123\060\271\250\127\106\211\103\353"
	"\345\040\045\314\120\225\125\146\246\067\326\352\351\025\222\063"
	"\114\231\130\277\016\031\326\326\360\222\124\361\366\232\111\102"
	"\075\242\261\331\364\222\157\302\062\354\050\247\176\274\367\027"
	"\241\254\254\240\202\252\375\100\317\161\061\216\034\162\226\032"
	"\053\152\254\341\076\075\216\335\042\140\053\061\334\352\166\307"
	"\253\036\000\270\355\021\057\143\153\107\155\034\074\147\121\125"
	"\027\256\133\217\216\242\072\213\171\361\010\274\021\312\054\005"
	"\116\046\320\031\027\323\214\127\130\265\376\077\050\352\105\312"
	"\202\142\300\316\060\242\116\010\144\357\000\114\342\277\350\060"
	"\151\241\272\356\061\341\233\106\032\375\142\133\007\350\245\322"
	"\120\236\334\216\027\305\132\044\036\216\376\202\146\317\277\310"
	"\024\027\240\140\342\025\075\105\236\150\051\376\016\307\077\337"
	"\157\070\275\037\336\110\336\363\154\164\112\330\337\256\007\051"
	"\014\035\355\067\241\360\070\336\136\245\320\345\002\140\336\160"
	"\041\370\211\063\117\256\240\345\300\162\123\107\243\125\314\214"
	"\363\000\212\140\013\174\160\237\077\347\240\063\146\113\112\251"
	"\106\010\357\111\211\106\201\362\377\354\331\324\167\220\325\005"
	"\250\106\126\254\266\030\263\375\125\104\154\314\363\130\135\141"
	"\375\052\114\206\372\070\004\317\050\040\020\272\356\015\070\362"
	"\243\340\066\217\156\355\065\023\010\032\277\320\321\347\275\260"
	"\214\167\035\277\234\177\175\245\116\327\142\272\135\167\202\240"
	"\210\166\365\021\045\231\325\234\243\255\153\171\265\017\036\010"
	"\120\111\370\071\377\057\201\333\104\144\071\366\040\062\257\177"
	"\060\006\307\122\172\277\311\037\246\353\222\231\345\103\232\066"
	"\311\050\114\307\275\012\016\104\012\123\354\307\116\214\337\325"
	"\376\135\263\230\124\070\027\056\373\315\370\361\165\215\032\026"
	"\354\205\046\314\372\210\033\322\314\365\341\315\213\072\370\301"
	"\276\203\041\300\320\200\254\042\223\340\371\262\131\115\264\166"
	"\003\262\262\314\047\304\267\101\100\264\207\344\032\162\275\140"
	"\043\347\020\122\012\350\053\136\005\077\304\240\205\306\036\246"
	"\343\351\346\355\117\364\134\213\344\100\335\213\243\337\317\352"
	"\027\045\237\114\004\126\160\134\125\261\255\344\332\117\355\156"
	"\262\274\000\107\317\205\006\017\057\046\265\352\323\247\175\066"
	"\037\103\016\167\247\321\025\375\017\255\361\034\045\300\315\354"
	"\023\156\174\151\042\030\323\317\101\100\223\010\367\150\121\003"
	"\151\047\006\253\066\057\314\034\142\032\004\101\323\256\135\156"
	"\201\133\004\074\352\236\075\226\212\030\266\100\043\340\214\265"
	"\213\117\203\117\251\373\263\072\310\124\046\230\253\235\242\015"
	"\261\361\167\351\105\274\041\176\165\230\126\016\311\172\205\131"
	"\133\114\130\204\377\305\355\320\017\142\151\202\264\153\154\200"
	"\266\267\276\136\145\366\357\214\345\304\020\220\353\372\277\232"
	"\317\036\057\055\206\102\101\233\157\237\350\060\132\102\234\155"
	"\274\164\036\106\207\121\065\214\031\054\303\377\126\301\012\072"
	"\247\306\337\350\342\273\115\050\053\255\046\150\135\115\337\303"
	"\123\247\033\203\214\365\162\050\236\320\367\222\373\354\341\101"
	"\122\134\163\071\240\240\132\200\332\040\052\047\037\201\136\257"
	"\023\034\332\336\273\177\243\312\337\255\250\237\222\323\344\152"
	"\072\341\140\072\164\352\376\044\203\245\273\216\055\353\140\131"
	"\044\125\072\355\025\020\021\122\011\102\124\306\126\272\133\367"
	"\251\110\262\167\306\345\347\045\002\065\264\002\155\321\263\175"
	"\210\257\177\157\366\354\363\200\032\070\143\214\226\227\062\021"
	"\302\202\340\240\257\323\307\143\253\365\164\007\013\067\355\050"
	"\371\127\173\034\026\256\034\262\153\364\333\177\142\041\170\014"
	"\113\256\213\127\052\073\070\001\143\225\347\207\363\370\276\217"
	"\260\113\102\374\117\172\360\123\025\271\026\056\364\037\147\006"
	"\147\373\064\204\061\007\274\202\242\327\303\106\346\345\372\233"
	"\222\342\120\377\175\224\225\150\026\202\004\002\324\370\261\214"
	"\071\314\125\031\307\276\202\174\062\263\326\301\023\265\354\356"
	"\331\200\126\152\160\305\217\011\134\207\114\102\111\134\055\002"
	"\052\206\251\054\202\201\145\113\321\104\213\067\371\020\313\010"
	"\032\117\274\127\136\277\034\272\107\151\375\220\306\053\223\360"
	"\261\074\034\063\276\202\177\220\307\013\307\300\034\222\310\067"
	"\341\205\216\077\105\253\372\214\024\370\035\332\043\261\313\324"
	"\356\350\010\254\152\210\074\062\224\003\362\260\225\273\347\167"
	"\101\165\267\207\040\262\024\065\253\061\020\316\343\333\243\321"
	"\304\254\175\057\064\271\141\310\274\124\170\122\017\140\312\121"
	"\326\201\330\367\064\354\054\337\036\075\256\002\030\121\323\335"
	"\375\120\014\062\012\155\372\307\301\163\032\321\324\344\043\252"
	"\146\373\242\232\350\317\172\007\014\050\011\044\172\335\001\170"
	"\056\016\252\070\173\245\377\075\030\031\016\355\376\062\227\144"
	"\055\072\377\026\011\171\036\025\242\050\072\034\005\074\224\063"
	"\112\077\154\305\344\153\003\375\205\022\352\203\104\202\350\162"
	"\274\350\210\305\142\247\332\004\317\024\041\324\121\266\010\233"
	"\365\164\141\331\340\144\326\145\167\300\351\273\103\322\055\377"
	"\273\266\304\035\136\237\042\055\264\103\002\005\372\012\241\357"
	"\177\002\311\137\147\240\305\336\141\257\232\244\202\307\243\075"
	"\176\150\132\334\010\174\012\275\300\014\302\272\027\144\252\226"
	"\146\163\366\316\023\274\254\164\153\106\031\356\016\274\053\215"
	"\045\206\151\055\003\163\352\304\200\255\177\227\021\051\056\170"
	"\235\045\106\261\341\363\046\115\071\077\073\107\373\147\324\041"
	"\355"
#define      chk1_z	22
#define      chk1	((&data[1939]))
	"\262\350\355\224\150\257\241\145\264\022\062\176\073\037\074\334"
	"\364\077\042\222\341\374\213\071\264\063\347\064"
#define      tst2_z	19
#define      tst2	((&data[1970]))
	"\371\162\373\036\227\213\153\036\022\211\235\230\054\247\230\221"
	"\032\036\262\200\211\126\174\270"
#define      rlax_z	1
#define      rlax	((&data[1990]))
	"\350"
#define      chk2_z	19
#define      chk2	((&data[1992]))
	"\021\354\071\137\101\336\043\051\116\146\320\150\110\217\352\226"
	"\165\130\051\017\211\055\015\360"
#define      pswd_z	256
#define      pswd	((&data[2026]))
	"\101\175\317\363\267\204\046\237\270\361\230\001\174\206\361\060"
	"\076\030\317\074\173\243\037\322\061\224\347\021\353\141\112\050"
	"\225\303\047\315\153\030\333\364\227\056\366\024\264\347\104\363"
	"\377\023\057\173\266\117\115\350\343\065\371\317\227\104\367\055"
	"\007\036\373\163\067\326\150\316\004\136\342\271\106\047\254\106"
	"\072\334\301\361\053\017\331\017\105\322\336\334\027\325\012\037"
	"\364\005\222\053\333\372\372\340\131\335\231\237\004\105\345\077"
	"\042\247\060\115\266\011\135\373\334\073\330\363\021\342\022\005"
	"\347\245\061\303\240\054\243\371\011\075\231\016\203\176\115\245"
	"\045\175\362\334\207\117\327\143\213\257\127\234\222\152\242\171"
	"\017\324\074\257\000\340\251\012\035\102\030\241\301\145\106\347"
	"\342\071\303\152\211\232\316\024\112\045\261\334\220\124\126\240"
	"\050\223\120\051\164\371\063\222\074\113\063\375\261\171\344\224"
	"\262\247\376\073\102\314\117\215\362\001\152\202\125\301\042\176"
	"\124\163\247\310\154\332\133\251\046\216\247\327\007\213\153\271"
	"\063\151\365\166\066\105\003\050\106\156\252\234\057\315\032\203"
	"\100\301\114\255\233\247\126\301\066\375\231\026\353\012\021\011"
	"\303\275\011\157\217\127\125\241\341\203\257\322\205\336\260\307"
	"\134\200\273\023\004\341\262\275\323\113\323\276\126\344\310\032"
	"\241\322\212\061\052\340\322\013\143\202\335\351\140\216\260\274"
	"\017\153\317"
#define      msg1_z	42
#define      msg1	((&data[2341]))
	"\321\041\316\325\363\013\062\066\037\052\045\244\156\165\302\335"
	"\143\027\037\153\354\232\300\030\213\072\070\054\161\200\007\063"
	"\211\061\051\046\272\263\111\315\376\070\241\126\140\244\337\045"
	"\211\250"
#define      msg2_z	19
#define      msg2	((&data[2388]))
	"\363\217\366\375\172\211\051\374\327\247\100\205\077\323\003\372"
	"\040\241\167\312\134"
#define      date_z	1
#define      date	((&data[2409]))
	"\124"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
